CREATE FUNCTION getTableSeqValue "long nextValue=-1;def db = orient.getDatabase(); def results = null; String updateQuery=\"UPDATE ${seqName} INCREMENT ${valueColumnName} = ${inc} return after \\$current WHERE ${pkColumnName} = '${pkColumnValue}'\"; String selectQuery = \"select from ${seqName} where ${pkColumnName}='{pkColumnValue}'\"; String insertQuery = \"insert into ${seqName} (${pkColumnName},${valueColumnName}) values('${pkColumnValue}',${initValue})\"; try {results = db.command(updateQuery); if (results.length==0) {try {db.command(insertQuery);} catch (Exception e2) {throw e2;}; nextValue=Long.parseLong(\"${initValue}\"); } else { nextValue=results[0].field(\"${valueColumnName}\");}; } catch (Exception e) { throw e; };   return nextValue; " PARAMETERS [seqName,pkColumnName,pkColumnValue,valueColumnName,initValue,inc] LANGUAGE GROOVY